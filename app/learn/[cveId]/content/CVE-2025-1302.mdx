# 취약점 개요

import {
  Table,
  TableHeader,
  TableBody,
  TableRow,
  TableHead,
  TableCell,
} from "@/components/ui/table"

## 📋 설명

JSONPath-Plus는 JSON 데이터에서 특정 값을 추출하는 오픈소스 라이브러리로, **npm 생태계에서 860개 이상의 패키지**가 의존하고 있습니다.

이 취약점은 Node.js vm 모듈의 샌드박스 탈출 취약점(CVE-2024-21534)의 불완전한 패치로 인해 발생했습니다. 블랙리스트 기반 필터링이 우회 가능해서, 공격자가 **악의적인 JSONPath 표현식을 통해 서버에서 임의의 코드를 실행**할 수 있습니다.

## ⚠️ 왜 위험한가?

**광범위한 영향**: kubernetes-client를 포함한 수많은 프로덕션 환경에서 사용

**체이닝 공격 가능**: 초기 침투 후 권한 상승, 데이터 탈취, 랜섬웨어 설치 등 연계 공격

**탐지 어려움**: 정상적인 JSON 쿼리로 위장 가능

---

# 공격 시나리오

**Initial Access:** 공격자가 취약한 JSONPath-Plus를 사용하는 API 엔드포인트에 악의적 쿼리 전송

**Execution:** vm 샌드박스를 우회하여 임의의 Node.js 코드 실행

**Persistence:** 리버스 쉘을 통해 서버 제어권 확보

**Impact:** 크립토마이너 설치 또는 데이터 암호화(랜섬웨어)

---

## 실습 환경 구성

<div className="dark-table">
  <Table>
    <TableHeader>
      <TableRow>
        <TableHead>역할</TableHead>
        <TableHead>구성</TableHead>
        <TableHead>IP</TableHead>
      </TableRow>
    </TableHeader>
    <TableBody>
      <TableRow>
        <TableCell>피해자 서버</TableCell>
        <TableCell>Node.js + JSONPath-Plus 10.2.0</TableCell>
        <TableCell>10.233.3.66</TableCell>
      </TableRow>
      <TableRow>
        <TableCell>공격자</TableCell>
        <TableCell>Kali Linux</TableCell>
        <TableCell>10.233.78.36</TableCell>
      </TableRow>
    </TableBody>
  </Table>
</div>


## 사전 준비사항

Node.js 18.x 이상

npm 또는 yarn

기본적인 JavaScript 지식

---

# 패치 정보

JSONPath-Plus **10.3.0 이상**으로 업그레이드

Input validation 강화: 사용자 입력을 JSONPath 쿼리로 사용하지 않기

샌드박스 환경 개선: `isolated-vm` 등 더 안전한 대안 고려

모니터링 강화: 비정상적인 프로세스 실행 탐지

---

# 참고 자료

[NVD 상세정보](https://nvd.nist.gov/vuln/detail/CVE-2025-1302)

[JSONPath-Plus GitHub](https://github.com/JSONPath-Plus/JSONPath)

[관련 취약점 CVE-2024-21534](https://nvd.nist.gov/vuln/detail/CVE-2024-21534)
